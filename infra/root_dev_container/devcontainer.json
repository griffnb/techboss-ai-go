{
	"name": "TechBoss - Go Backend + Node Frontend",
	"dockerComposeFile": ["./docker-compose.yml"],
	"service": "backend",
	"runServices": ["backend", "db", "redis", "localstack", "dynamodb"],
	"shutdownAction": "stopCompose",
	"workspaceFolder": "/workspaces",
	
	"features": {
		"ghcr.io/devcontainers/features/common-utils:2": {
			"installZsh": "true",
			"upgradePackages": "true"
		},
		"ghcr.io/devcontainers/features/git:1": {
			"version": "latest",
			"ppa": "false"
		},
		"ghcr.io/devcontainers/features/github-cli:1": {
			"installDirectlyFromGitHubRelease": true,
			"version": "latest"
		},
		"ghcr.io/devcontainers/features/node:1": {
			"nodeGypDependencies": true,
			"version": "22"
		}
	},

	"containerEnv": {
		"PNPM_HOME": "/usr/local/bin",
		"NODE_ENV": "development"
	},

	"portsAttributes": {
		"8085": { "label": "Go Backend", "requireLocalPort": false },
		"3000": { "label": "Frontend Dev Server", "requireLocalPort": false },
		"4321": { "label": "Astro Dev Server", "requireLocalPort": false },
		"5173": { "label": "Vite Dev Server", "requireLocalPort": false },
		"5432": { "label": "PostgreSQL", "requireLocalPort": false },
		"6379": { "label": "Redis", "requireLocalPort": false },
		"4467": { "label": "LocalStack", "requireLocalPort": false },
		"8002": { "label": "DynamoDB Local", "requireLocalPort": false }
	},

	"forwardPorts": [8085, 3000, 4321, 5173, 5432, 6379, 4467, 8002],

	"postCreateCommand": "bash -c 'cd /workspaces/techboss-ai-go && go mod download && go mod tidy && cd /workspaces/techboss-ai && corepack enable && pnpm install'",

	"overrideCommand": false,
	"remoteUser": "root",

	"customizations": {
		"vscode": {
			"extensions": [
				// Go Development
				"golang.go",
				
				// Node/TypeScript/React Development  
				"ms-vscode.vscode-typescript-next",
				"bradlc.vscode-tailwindcss",
				"esbenp.prettier-vscode",
				"dbaeumer.vscode-eslint",
				"astro-build.astro-vscode",
				
				// General Development
				"ms-vscode.vscode-json",
				"ms-vscode.vscode-docker",
				"ms-azuretools.vscode-docker",
				"github.vscode-pull-request-github",
				"github.copilot",
				"github.copilot-chat",
				"github.vscode-github-actions",
				
				// Database & Infrastructure
				"ms-ossdata.vscode-postgresql",
				
				// Productivity & UI
				"formulahendry.auto-rename-tag",
				"usernamehw.errorlens",
				"bradgashler.htmltagwrap",
				"Gruntfuggly.todo-tree",
				"ms-vscode.vscode-git-graph",
				"eamodio.gitlens",
				"ms-vscode.remote-containers"
			],
			"settings": {
				// Go Settings
				"go.gopath": "/go",
				"go.goroot": "/usr/local/go", 
				"go.toolsManagement.checkForUpdates": "local",
				"go.useLanguageServer": true,
				"go.formatTool": "goimports",
				"go.lintTool": "golangci-lint",
				
				// TypeScript/Node Settings
				"typescript.updateImportsOnFileMove.enabled": "always",
				"typescript.preferences.includePackageJsonAutoImports": "auto",
				
				// Tailwind CSS
				"tailwindCSS.experimental.classRegex": [
					["cn\\(([^)]*)\\)", "'([^']*)'"],
					["clsx\\(([^)]*)\\)", "'([^']*)'"]
				],
				
				// Formatting & Linting
				"editor.formatOnSave": true,
				"editor.codeActionsOnSave": {
					"source.organizeImports": "explicit"
				},
				"prettier.requireConfig": true,
				"eslint.workingDirectories": [
					"/workspaces/techboss-ai",
					"/workspaces/techboss-ai/apps", 
					"/workspaces/techboss-ai/packages",
					"/workspaces/techboss-ai/sites"
				],
				
				// File Associations
				"files.associations": {
					"*.go": "go",
					"go.mod": "go.mod", 
					"go.sum": "go.sum",
					"*.astro": "astro",
					"*.tsx": "typescriptreact",
					"*.ts": "typescript"
				}
			}
		}
	}
}
